<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        <!-- Kế thừa giao diện hiện có -->
        <record id="view_employee_form_inherit" model="ir.ui.view">
            <field name="name">hr.employee.form.inherit</field>
            <field name="model">hr.employee</field>
            <field name="inherit_id" ref="hr.view_employee_form"/>
            <field name="arch" type="xml">
                <data>
                    <xpath expr="//page[@name='personal_information']" position="inside">
                        <group string="Mối quan hệ của Nhân viên"> 
                            <field name="relationship_ids" mode="tree,kanban">
                                <tree editable="bottom">
                                    <field name="name" attrs="{'name': 'name'}" groups="hr.group_hr_user"/>
                                    <field name="relation_type" attrs="{'name': 'relation_type'}" groups="hr.group_hr_user"/>
                                </tree>
                            </field>
                        </group>
                        <group string="Hồ sơ Y tế" name="medical_records_page">
                            <field name="medical_record_ids" widget="one2many_list">
                                <tree>
                                    <field name="date" attrs="{'name': 'date'}"/>
                                    <field name="diagnosis" attrs="{'name': 'diagnosis'}" groups="hr.group_hr_user"/>
                                    <field name="treatment" attrs="{'name': 'treatment'}" groups="hr.group_hr_user"/>
                                </tree>
                            </field>
                        </group>
                    </xpath>
                </data>
            </field>
        </record>

        <record id="employee_report_action" model="ir.actions.report">
            <field name="name">Báo cáo nhân viên</field>
            <field name="model">hr.employee</field>
            <field name="report_type">qweb-pdf</field>
            <field name="report_name">my_employee.report_employee</field>
            <field name="file">my_employee.report_employee</field>
        </record>

        <template id="report_employee">
        <main>
            <t t-call="web.external_layout">
                <t t-foreach="docs" t-as="doc">
                
                    <div class="page">
                        <h1>Báo cáo nhân viên</h1>
                        <table class="table table-sm table-bordered">
                            <thead>
                                <tr>
                                    <th>Họ tên</th>
                                    <th>Ngày sinh</th>
                                    <th>Trình độ</th>
                                    <th>Chuyên ngành</th>
                                    <th>Bộ phận</th>
                                    <th>Số sổ BHXH</th>
                                    <th>Ghi chú</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><span t-esc="doc.name"/></td>
                                    <td><span t-esc="doc.birthday"/></td>
                                    <td><span t-esc="doc.certificate"/></td>
                                    <td><span t-esc="doc.study_field"/></td>
                                    <td><span t-esc="doc.department_id"/></td>
                                    <td><span t-esc="doc.ssnid"/></td>
                                    <td><span t-esc="doc.notes"/></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                
                </t>
            </t>
            </main>
        </template>

        <report
            id="report_employee"
            string="My PDF Report"
            model="hr.employee"
            report_type="qweb-pdf"
            name="my_employee.report_employee"
            file="my_employee.report_employee"
            attachment_use="True"
        />

        <menuitem id="menu_employee_report" name="Báo cáo nhân viên" parent="hr.menu_hr_root" sequence="20"/>
        <menuitem id="menu_employee_report_list" name="Danh sách báo cáo nhân viên" parent="menu_employee_report" action="employee_report_action" sequence="10"/>

    </data>
</odoo>
